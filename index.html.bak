<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://formspree.io; img-src 'self' data: https:; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; script-src 'self' https://cdn.jsdelivr.net https://cdn.tailwindcss.com 'unsafe-inline' 'unsafe-eval'; base-uri 'self'; frame-ancestors 'none'; object-src 'none';">
    <title>AsanzaDev — Portfolio</title>
    <meta name="description" content="Portfolio site — AsanzaDev" />
    <link rel="icon" href="assets/favicon.ico" />
    <!-- Tailwind via CDN (no build step) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
      /* Prevent anchored sections from being hidden behind the sticky header */
      :root{--header-offset:64px}
      main > section { scroll-margin-top: calc(var(--header-offset) + 0.5rem); }
      @media (min-width:768px) {
        /* header height slightly larger on md+ due to layout */
        :root{--header-offset:72px}
      }
    </style>
    <link rel="stylesheet" href="css/styles.css">
  </head>
  <body class="bg-gray-50 text-gray-900 antialiased">
    <header x-data="{open:false}" class="sticky top-0 z-50 bg-white/60 backdrop-blur border-b">
        <div class="max-w-4xl mx-auto p-4 flex items-center justify-between">
        <a href="#home" class="flex items-center gap-3">
          <img src="assets/logo.png" alt="AsanzaDev" class="w-8 h-8 object-contain" />
          <span class="sr-only">AsanzaDev — Home</span>
        </a>

        <nav class="hidden md:flex items-center gap-4">
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#home">Home</a>
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#about">About Me</a>
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#training">Training</a>
          <!-- Portfolio removed -->
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#experience">Experience</a>
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#technologies">Technologies</a>
          <a class="text-sm text-gray-700 hover:text-indigo-600" href="#contact">Contact</a>
        </nav>

        <div class="md:hidden">
          <button @click="open = !open" aria-expanded="false" :aria-expanded="open" class="p-2 rounded-md text-gray-700 hover:bg-gray-100">
            <svg x-show="!open" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
            <svg x-show="open" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
          </button>
        </div>
      </div>

      <div x-show="open" x-cloak class="md:hidden border-t">
        <div class="px-4 py-3 space-y-2">
          <a class="block text-gray-700 py-2" href="#home" @click="open = false">Home</a>
          <a class="block text-gray-700 py-2" href="#about" @click="open = false">About Me</a>
          <a class="block text-gray-700 py-2" href="#training" @click="open = false">Training</a>
          <!-- Portfolio removed -->
          <a class="block text-gray-700 py-2" href="#experience" @click="open = false">Experience</a>
          <a class="block text-gray-700 py-2" href="#technologies" @click="open = false">Technologies</a>
          <a class="block text-gray-700 py-2" href="#contact" @click="open = false">Contact</a>
        </div>
      </div>
    </header>

    <main class="max-w-4xl mx-auto p-6">
      <section id="home" class="mb-16">
        <div class="max-w-4xl mx-auto px-6 py-6 sm:py-12">
          <div class="flex items-center gap-4 mb-4">
            <img src="assets/photo.jpeg" alt="Your photo" class="w-14 h-14 rounded-full object-cover bg-gray-200" />
            <div>
              <h2 class="text-lg font-semibold">Luis Asanza</h2>
              <p class="text-sm text-gray-500">Senior .NET Engineer</p>
            </div>
          </div>
          <div>
            <h1 class="text-4xl sm:text-5xl font-extrabold leading-tight">Building resilient, maintainable systems using Clean Architecture</h1>
            <p class="mt-4 text-gray-600 max-w-xl">I design and implement enterprise-grade .NET applications with clear separation of concerns, testability, and production-ready practices.</p>
            <div class="mt-6">
              <a href="#contact" class="inline-block px-4 py-2 bg-indigo-600 text-white rounded shadow hover:bg-indigo-700">Contact me</a>
            </div>
          </div>
        </div>
      </section>

      <section id="about" class="mb-10">
        <h3 class="text-lg font-semibold">About Me</h3>
        <div class="mt-2 sm:flex sm:items-start sm:gap-6">
          <div class="flex-1">
            <p class="text-gray-600">Senior Engineer with 13+ years of experience in the .NET ecosystem. Following a decade of success in the healthcare sector, I dedicated the past year to an intentional technical pivot: mastering Clean Architecture, ASP.NET Core modernization, and AI-integrated workflows to deliver high-performance, secure enterprise solutions.</p>
            <ul class="mt-3 text-sm text-gray-600 list-disc list-inside space-y-1">
              <li><strong>Architecture:</strong> Design and implement Clean Architecture and Vertical Slice systems with a focus on Domain-Driven Design (DDD).</li>
              <li><strong>Ecosystem:</strong> Expert in the .NET stack (C#, EF Core, SQL) with 10 years of specialized experience in high-compliance Healthcare/Renal software for US hospitals.</li>
              <li><strong>Modernization & Cloud:</strong> Proficient in Azure services, building automated CI/CD pipelines with GitHub Actions, and integrating AI/LLM capabilities via GitHub Copilot and MCP.</li>
              <li><strong>Quality:</strong> Dedicated to maintainable code through Unit Testing, FluentValidation, and structured logging (Serilog).</li>
            </ul>
            
          </div>
          <div class="mt-4 sm:mt-0 sm:w-40">
            <img src="assets/about.png" alt="Luis Asanza" class="w-36 h-36 rounded-full object-cover shadow mx-auto block" />
          </div>
        </div>
      </section>

      <section id="training" class="space-y-6 mb-16">
        <h3 class="text-lg font-semibold">Certifications and Training</h3>

        <div class="grid md:grid-cols-2 gap-6">
          <div id="certifications-root" x-data="certificationsApp()" class="bg-white p-4 rounded shadow h-[400px] flex flex-col">
            <h4 class="font-medium">Latest Certifications</h4>
            <template x-if="loading">
              <div class="text-sm text-gray-600 mt-3">Loading certifications…</div>
            </template>
            <template x-if="!loading && error">
              <div class="text-sm text-red-600 mt-3" x-text="error"></div>
            </template>
            <template x-if="!loading">
              <div class="mt-3 flex-1 overflow-y-auto pr-2">
                <ul class="space-y-3">
                  <template x-for="c in latest" :key="c.id">
                    <li class="flex items-center justify-between border p-3 rounded">
                      <div class="flex items-center gap-3">
                        <img :src="c.iconUrl || 'assets/badge.svg'" alt="badge" class="w-12 h-12 object-contain rounded" />
                        <div>
                          <div class="text-sm font-semibold" x-text="c.name"></div>
                          <div class="text-xs text-gray-500" x-text="c.issuer"></div>
                          <div class="text-xs text-gray-500" x-text="formatIssued(c.dateEarned)"></div>
                          <template x-if="c.issuer === 'Microsoft'">
                            <a :href="c.certificationURL || '#'" class="text-sm text-indigo-600 hover:underline" target="_blank" rel="noopener">View certification details</a>
                          </template>
                        </div>
                      </div>
                      <div>
                        <span x-text="c.status" :class="c.status === 'Active' ? 'inline-block px-2 py-1 rounded-full text-xs bg-green-100 text-green-800' : (c.status === 'Expired' ? 'inline-block px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800' : 'inline-block px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700')"></span>
                      </div>
                    </li>
                  </template>
                </ul>
              </div>
            </template>
          </div>

          <div id="achievements-root" x-data="achievementsApp()" class="bg-white p-4 rounded shadow h-[400px] flex flex-col">
            <h4 class="font-medium">Latest Microsoft Training Achievements</h4>

            <template x-if="loading">
              <div class="text-sm text-gray-600 mt-3">Loading achievements…</div>
            </template>
            <template x-if="!loading && error">
              <div class="text-sm text-red-600 mt-3" x-text="error"></div>
            </template>
            <template x-if="!loading">
              <div class="mt-3 flex-1 overflow-y-auto pr-2">
                <ul class="space-y-3">
                  <template x-for="a in latest" :key="a.id">
                    <li class="flex items-center justify-between border p-3 rounded">
                      <div class="flex items-center gap-3">
                        <img :src="a.imageUrl || 'assets/badge.svg'" alt="badge" class="w-12 h-12 object-contain rounded" />
                        <div>
                          <div class="text-sm font-semibold" x-text="a.title"></div>
                          <div class="text-xs text-gray-500" x-text="displayCategory(a.category)"></div>
                          <div class="text-xs text-gray-500" x-text="formatCompleted(a.grantedOn)"></div>
                          <a :href="a.detailsUrl || '#'" class="text-sm text-indigo-600 hover:underline" target="_blank" rel="noopener">View details</a>
                        </div>
                      </div>
                      <div>
                        <span class="inline-block px-2 py-1 rounded-full text-xs bg-green-100 text-green-800">Completed</span>
                      </div>
                    </li>
                  </template>
                </ul>
              </div>
            </template>
          </div>
        </div>
      </section>

        <!-- Portfolio section removed temporarily -->

        <section id="experience" class="mb-10">
          <h3 class="text-lg font-semibold">Experience</h3>
          <div class="mt-6">
            <div class="relative">
              <div class="absolute left-6 top-6 bottom-6 w-px bg-gray-200"></div>

              <!-- Portfolio Timeline Entry (current) -->
              <div class="flex items-start gap-4 mb-8 relative pl-12">
                <img src="assets/modernization.png" alt="Technical Modernization" class="w-14 h-14 rounded-md object-cover flex-shrink-0 shadow" />
                <div class="flex-1">
                  <div class="flex items-center justify-between">
                    <div>
                      <div class="text-lg font-semibold">Senior Software Engineer (Technical Modernization)</div>
                      <div class="text-sm text-gray-500">Buenos Aires, Argentina</div>
                      <div class="text-sm text-gray-500 md:hidden js-duration" data-start="2025-02-01" data-end="Present"></div>
                    </div>
                    <div class="text-sm text-gray-500 hidden md:block js-duration" data-start="2025-02-01" data-end="Present"></div>
                  </div>
                  <div class="mt-3 text-sm text-gray-600 hidden sm:block">
                    <ul class="list-disc list-inside space-y-1">
                      <li>Intentional pivot to cloud-native .NET and modern architecture.</li>
                      <li>Development of a Renal Health System using Clean Architecture.</li>
                      <li>Implementation of advanced web security and unit testing.</li>
                      <li>Integration of AI tools and Azure AI certification.</li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Verndale -->
              <div class="flex items-start gap-4 mb-8 relative pl-12">
                <img src="assets/verndale.jpg" alt="Verndale" class="w-14 h-14 rounded-md object-cover flex-shrink-0 shadow" />
                <div class="flex-1">
                  <div class="flex items-center justify-between">
                    <div>
                      <div class="text-lg font-semibold">Verndale</div>
                      <div class="text-sm text-gray-500">Quito, Ecuador</div>
                      <div class="text-sm text-gray-500 md:hidden js-duration" data-start="2021-09-01" data-end="2025-02-01"></div>
                    </div>
                    <div class="text-sm text-gray-500 hidden md:block js-duration" data-start="2021-09-01" data-end="2025-02-01"></div>
                  </div>
                  <div class="mt-3 pl-6">
                    <div class="font-medium">Senior Engineer</div>
                    <div class="text-sm text-gray-500 js-duration" data-start="2021-09-01" data-end="2025-02-01"></div>
                    <div class="text-sm text-gray-600 mt-2 hidden sm:block">Enterprise System Migration: Contributed to the technical migration of a high-traffic, worldwide system to Sitecore XP 10, strictly following platform standards to ensure architectural consistency across global regions.</div>
                    <div class="text-sm text-gray-600 mt-2 hidden sm:block">Platform Governance & Usability: Improved the content authoring experience by implementing detailed field descriptions and custom thumbnails, ensuring non-technical clients could manage complex modules effectively.</div>
                    <div class="text-sm text-gray-600 mt-2 hidden sm:block">Resilient Engineering: Utilized defensive programming to eliminate runtime exceptions and implemented structured logging to facilitate faster troubleshooting and system monitoring.</div>
                    <div class="text-sm text-gray-600 mt-2 hidden sm:block">Security & Maintenance: Managed the proactive application of Sitecore security patches and balanced technical tasks across multiple concurrent projects for US and global clients.</div>
                  </div>
                </div>
              </div>

              <!-- Visonex (company header) -->
              <div class="flex items-start gap-4 mb-4 relative pl-12">
                <img src="assets/visonex.avif" alt="Visonex" class="w-14 h-14 rounded-md object-cover flex-shrink-0 shadow" />
                <div class="flex-1">
                  <div class="flex items-center justify-between">
                    <div>
                      <div class="text-lg font-semibold">Visonex</div>
                      <div class="text-sm text-gray-500">Quito, Ecuador</div>
                      <div class="text-sm text-gray-500 md:hidden js-duration" data-start="2012-01-01" data-end="2021-09-01"></div>
                    </div>
                    <div class="text-sm text-gray-500 hidden md:block js-duration" data-start="2012-01-01" data-end="2021-09-01"></div>
                  </div>
                  <div class="mt-3 space-y-4">
                    <div class="pl-6">
                      <div class="font-medium">Software Engineer</div>
                      <div class="text-sm text-gray-500 js-duration" data-start="2021-01-01" data-end="2021-09-01"></div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Engineering Leadership: Promoted to lead a cross-functional team, overseeing the development of mission-critical healthcare software for US hospitals.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Project Governance: Managed the full SDLC for HIPAA-compliant features in electronic health records (EHR), ensuring 100% data integrity for renal patient care.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Team Quality: Established a culture of quality that resulted in the lowest bug counts in the department by implementing structured design patterns and comprehensive integration testing.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Mentorship: Guided junior developers through architectural transitions and established best practices for .NET development.</div>

                    </div>

                    <div class="pl-6">
                      <div class="font-medium">Senior Developer</div>
                      <div class="text-sm text-gray-500 js-duration" data-start="2018-01-01" data-end="2021-01-01"></div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Framework Evolution: Spearheaded the successful large-scale migration of legacy Classic ASP codebases to the .NET MVC framework.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">System Stability: Reduced technical debt and improved system uptime by refactoring legacy modules into maintainable, object-oriented C# code.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Full-Stack Delivery: Collaborated with product teams to deliver functional requirements on schedule, specializing in complex data-driven healthcare modules.</div>
                    </div>

                    <div class="pl-6">
                      <div class="font-medium">Software Developer</div>
                      <div class="text-sm text-gray-500 js-duration" data-start="2012-01-01" data-end="2018-01-01"></div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Legacy Modernization: Rapidly progressed from maintaining Classic ASP and ASP.NET Web Forms to implementing modern .NET MVC solutions, gaining a deep architectural understanding of the framework's evolution.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Backlog Optimization: Recognized for high-velocity delivery; consistently cleared extensive maintenance backlogs by identifying and resolving complex bugs in legacy healthcare systems.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Frontend Proficiency: Mastered jQuery, JavaScript, and HTML5 to enhance user interfaces, ensuring cross-browser compatibility and improving the user experience for clinical staff.</div>
                      <div class="text-sm text-gray-600 mt-2 hidden sm:block">Foundation in Quality: Developed a "security-first" and "low-bug" mindset early by working on high-compliance medical software where data integrity was mission-critical.</div>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </section>

        <section id="technologies" class="mb-10">
          <h3 class="text-lg font-semibold">Technologies</h3>
          <div class="mt-4 grid grid-cols-2 sm:grid-cols-4 gap-4">
            <div class="flex flex-col items-center p-4 bg-white rounded shadow">
              <div class="text-xl font-semibold">.NET</div>
              <div class="text-sm text-gray-500 mt-1">ASP.NET Core</div>
            </div>
            <div class="flex flex-col items-center p-4 bg-white rounded shadow">
              <div class="text-xl font-semibold">C#</div>
              <div class="text-sm text-gray-500 mt-1">Language</div>
            </div>
            <div class="flex flex-col items-center p-4 bg-white rounded shadow">
              <div class="text-xl font-semibold">Azure</div>
              <div class="text-sm text-gray-500 mt-1">Cloud</div>
            </div>
            <div class="flex flex-col items-center p-4 bg-white rounded shadow">
              <div class="text-xl font-semibold">SQL</div>
              <div class="text-sm text-gray-500 mt-1">Databases</div>
            </div>
          </div>
        </section>

        <section id="contact" class="mb-6">
          <h3 class="text-lg font-semibold">Contact</h3>
          <div class="mt-6 bg-white p-6 rounded shadow">
            <div class="max-w-2xl mx-auto">
              <form id="my-form" action="https://formspree.io/f/mreapwaa" method="POST" class="grid gap-4">
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                  <input id="email" name="email" type="email" required placeholder="you@example.com" class="mt-1 block w-full rounded border-gray-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2" />
                </div>

                <div>
                  <label for="message" class="block text-sm font-medium text-gray-700">Message</label>
                  <textarea id="message" name="message" rows="6" required placeholder="Write your message..." class="mt-1 block w-full rounded border-gray-200 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2"></textarea>
                </div>

                <div class="flex items-center gap-4">
                  <button id="my-form-button" type="submit" class="inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded shadow hover:bg-indigo-700 disabled:opacity-60">Send Message</button>
                  <p id="my-form-status" class="text-sm text-gray-600"></p>
                </div>
              </form>
            </div>
          </div>
        </section>
    </main>

    <footer class="mt-12 border-t bg-white/60 backdrop-blur">
      <div class="max-w-4xl mx-auto px-6 py-8">
        <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-6">
          <div>
            <a href="#home" class="flex items-center gap-3">
              <img src="assets/logo.png" alt="AsanzaDev" class="w-6 h-6 object-contain" />
              <span class="sr-only">AsanzaDev</span>
            </a>
          </div>

          <div class="flex items-center gap-4">
            <a aria-label="GitHub" href="https://github.com/luisAsanza" class="text-gray-600 hover:text-gray-900">
              <img src="assets/github.png" alt="GitHub" class="w-5 h-5 object-contain" />
            </a>
            <a aria-label="LinkedIn" href="https://www.linkedin.com/in/luis-asanza/" class="text-gray-600 hover:text-gray-900">
              <img src="assets/linkedin.png" alt="LinkedIn" class="w-5 h-5 object-contain" />
            </a>
            <a aria-label="Instagram" href="https://www.instagram.com/luis.asanza.alvia/" target="_blank" rel="noopener" class="text-gray-600 hover:text-gray-900">
              <img src="assets/instagram.png" alt="Instagram" class="w-5 h-5 object-contain" />
            </a>
          </div>
        </div>
        <div class="mt-6 text-sm text-gray-500">© <span id="year">2026</span> Luis Asanza — All rights reserved.</div>
      </div>
    </footer>

    <div class="text-center text-sm text-gray-500 py-4">Powered by GitHub Actions &amp; Azure.</div>
    <script>document.getElementById('year').textContent = new Date().getFullYear();</script>
    <script src="js/main.js"></script>
    <script>
      // Vanilla-JS fallback renderer for certifications and achievements
      (function(){
        function createText(el, tag, className, text) {
          const n = document.createElement(tag);
          if (className) n.className = className;
          if (text) n.textContent = text;
          el.appendChild(n);
          return n;
        }

        async function fetchJson(path) {
          try {
            const res = await fetch(path);
            if (!res.ok) throw new Error('HTTP ' + res.status);
            return await res.json();
          } catch (e) { return null; }
        }

        function renderCertifications(root) {
          if (!root) return;
          // find list container inside the card (existing structure)
          const listHolder = root.querySelector('ul') || (function(){ const ul=document.createElement('ul'); ul.className='space-y-3'; root.appendChild(ul); return ul; })();
          listHolder.innerHTML = '';

          (async () => {
            const ms = await fetchJson('data/ms-certifications.json') || { certifications: [] };
            const other = await fetchJson('data/other-certifications.json') || { certifications: [] };
            const fallbackBadge = 'https://learn.microsoft.com/en-us/media/learn/certification/badges/microsoft-certified-general-badge.svg';

            const msItems = (Array.isArray(ms.certifications) ? ms.certifications : []).map(c => ({
              ...c,
              issuer: 'Microsoft',
              iconUrl: (c.iconUrl && (c.iconUrl.startsWith('http') ? c.iconUrl : (c.iconUrl.startsWith('/') ? 'https://learn.microsoft.com/en-us' + c.iconUrl : c.iconUrl))) || fallbackBadge,
              certificationURL: (c.certificationURL && (c.certificationURL.startsWith('http') ? c.certificationURL : 'https://learn.microsoft.com/en-us' + (c.certificationURL.startsWith('/') ? c.certificationURL : '/' + c.certificationURL)))
            }));

            const otherItems = (Array.isArray(other.certifications) ? other.certifications : []).map(c => ({
              ...c,
              issuer: c.issuer || 'Other',
              iconUrl: c.iconUrl ? (c.iconUrl.startsWith('/') ? c.iconUrl.slice(1) : c.iconUrl) : fallbackBadge,
              certificationURL: c.certificationURL && (c.certificationURL.startsWith('http') ? c.certificationURL : ('https://learn.microsoft.com/en-us' + (c.certificationURL.startsWith('/') ? c.certificationURL : '/' + c.certificationURL)))
            }));

            const merged = [...msItems, ...otherItems].map(i => ({ ...i, iconUrl: i.iconUrl || fallbackBadge }));
            const latest = merged.slice().sort((a,b) => new Date(b.dateEarned || 0) - new Date(a.dateEarned || 0)).slice(0,5);

            for (const item of latest) {
              const li = document.createElement('li'); li.className='flex items-center justify-between border p-3 rounded';
              const left = document.createElement('div'); left.className='flex items-center gap-3';
              const img = document.createElement('img'); img.src = item.iconUrl || fallbackBadge; img.alt='badge'; img.className='w-12 h-12 object-contain rounded';
              left.appendChild(img);
              const meta = document.createElement('div');
              createText(meta,'div','text-sm font-semibold', item.name || item.title || '');
              createText(meta,'div','text-xs text-gray-500', item.issuer || '');
              createText(meta,'div','text-xs text-gray-500', (item.dateEarned ? new Date(item.dateEarned).toLocaleDateString() : ''));
              left.appendChild(meta);
              li.appendChild(left);

              const right = document.createElement('div');
              const span = document.createElement('span'); span.className='inline-block px-2 py-1 rounded-full text-xs bg-green-100 text-green-800'; span.textContent = 'Completed';
              right.appendChild(span);
              li.appendChild(right);

              listHolder.appendChild(li);
            }
          })();
        }

        function renderAchievements(root) {
          if (!root) return;
          const listHolder = root.querySelector('ul') || (function(){ const ul=document.createElement('ul'); ul.className='space-y-3'; root.appendChild(ul); return ul; })();
          listHolder.innerHTML = '';

          (async () => {
            const json = await fetchJson('data/achievements.json') || { achievements: [] };
            const items = (Array.isArray(json.achievements) ? json.achievements : []).map(a => ({
              ...a,
              imageUrl: (a.imageUrl && (a.imageUrl.startsWith('http') ? a.imageUrl : (a.imageUrl.startsWith('/') ? 'https://learn.microsoft.com/en-us' + a.imageUrl : a.imageUrl)))
            }));
            const latest = items.slice().sort((a,b) => new Date(b.grantedOn || 0) - new Date(a.grantedOn || 0)).slice(0,5);

            for (const a of latest) {
              const li = document.createElement('li'); li.className='flex items-center justify-between border p-3 rounded';
              const left = document.createElement('div'); left.className='flex items-center gap-3';
              const img = document.createElement('img'); img.src = a.imageUrl || 'assets/badge.svg'; img.alt='badge'; img.className='w-12 h-12 object-contain rounded';
              left.appendChild(img);
              const meta = document.createElement('div');
              createText(meta,'div','text-sm font-semibold', a.title || '');
              createText(meta,'div','text-xs text-gray-500', a.category || '');
              createText(meta,'div','text-xs text-gray-500', (a.grantedOn ? new Date(a.grantedOn).toLocaleDateString() : ''));
              left.appendChild(meta);
              li.appendChild(left);

              const right = document.createElement('div');
              const span = document.createElement('span'); span.className='inline-block px-2 py-1 rounded-full text-xs bg-green-100 text-green-800'; span.textContent = 'Completed';
              right.appendChild(span);
              li.appendChild(right);

              listHolder.appendChild(li);
            }
          })();
        }

        document.addEventListener('DOMContentLoaded', () => {
          // If Alpine is missing or not initialized, run fallback
          if (typeof window.Alpine === 'undefined') {
            renderCertifications(document.getElementById('certifications-root'));
            renderAchievements(document.getElementById('achievements-root'));
          }
        });
      })();
    </script>
    <script>
      (function(){
        function formatMonthYear(d) {
          try { return new Date(d).toLocaleString(undefined, { month: 'short', year: 'numeric' }); } catch(e){ return d; }
        }
        function formatDurationMonths(totalMonths) {
          const years = Math.floor(totalMonths / 12);
          const months = totalMonths % 12;
          let parts = [];
          if (years > 0) parts.push(`${years} yr${years===1?'':'s'}`);
          if (months > 0) parts.push(`${months} mo${months===1?'':'s'}`);
          return parts.join(' ');
        }
        function computeAndRender(){
          const els = document.querySelectorAll('.js-duration');
          els.forEach(el => {
            const s = el.dataset.start;
            const e = el.dataset.end;
            if (!s) return;
            const start = new Date(s);
            const end = (e && e.toLowerCase() !== 'present') ? new Date(e) : new Date();
            let totalMonths = (end.getFullYear() - start.getFullYear())*12 + (end.getMonth() - start.getMonth());
            if (totalMonths < 0) totalMonths = 0;
            const duration = formatDurationMonths(totalMonths);
            const startLabel = formatMonthYear(start);
            const endLabel = (e && e.toLowerCase() !== 'present') ? formatMonthYear(end) : 'Present';
            // Build DOM nodes using textContent to avoid inserting untrusted HTML
            while (el.firstChild) el.removeChild(el.firstChild);
            const rangeSpan = document.createElement('span');
            rangeSpan.className = 'range';
            rangeSpan.textContent = startLabel + ' — ' + endLabel;
            el.appendChild(rangeSpan);
            if (duration) {
              const durSpan = document.createElement('span');
              durSpan.className = 'hidden md:inline';
              durSpan.textContent = ' · ' + duration;
              el.appendChild(durSpan);
            }
          });
        }
        if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', computeAndRender); else computeAndRender();
      })();
    </script>
  </body>
</html>
